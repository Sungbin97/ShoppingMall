<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.green.team4.mapper.sw.ReviewMpMapper">

    <!-- tbl_review 데이터 등록 -->
    <insert id="insert">
        <selectKey keyProperty="rno" resultType="Integer" order="AFTER">
            SELECT LAST_INSERT_ID()
        </selectKey>
        <![CDATA[
        insert into tbl_review (pno, mno, oINo, rRating, rContent)
        values (#{pno},#{mno},#{oINo},#{rRating},#{rContent})
        ]]>
    </insert>

    <!-- tbl_review 데이터 전체 가져오기(pno 단위) -->
    <select id="getAllByPno" resultType="com.green.team4.vo.sw.ReviewMpVO">
        select tbl_review.rno, tbl_review.pno, tbl_review.mno, tbl_review.oINo, tbl_review.rRating,
               tbl_review.rContent, tbl_review.LIKEHIT, tbl_review.rRegdate, tbl_review.rUpdatedate,
               tbl_orderItem.iName, tbl_orderItem.iOption, tbl_orderItem.iOptionName, tbl_orderItem.iOption2,
               tbl_orderItem.iOptionName2, tbl_orderItem.iColor, tbl_orderItem.iPrice, tbl_orderItem.iDiscount,
               tbl_orderItem.iDisPrice, tbl_orderItem.iCount, tbl_orderItem.iSavePoint, tbl_orderItem.iTotalPrice
        from tbl_review
        left outer join tbl_orderItem on tbl_review.oINo = tbl_orderItem.oINo
        where pno=#{pno}
        order by pno
    </select>

    <!-- tbl_review 데이터 전체 가져오기(mno 단위) -->
    <select id="getAllByMno" resultType="com.green.team4.vo.sw.ReviewMpVO">
        select tbl_review.rno, tbl_review.pno, tbl_review.mno, tbl_review.oINo, tbl_review.rRating,
               tbl_review.rContent, tbl_review.LIKEHIT, tbl_review.rRegdate, tbl_review.rUpdatedate,
               tbl_orderItem.iName, tbl_orderItem.iOption, tbl_orderItem.iOptionName, tbl_orderItem.iOption2,
               tbl_orderItem.iOptionName2, tbl_orderItem.iColor, tbl_orderItem.iPrice, tbl_orderItem.iDiscount,
               tbl_orderItem.iDisPrice, tbl_orderItem.iCount, tbl_orderItem.iSavePoint, tbl_orderItem.iTotalPrice
        from tbl_review
        left outer join tbl_orderItem on tbl_review.oINo = tbl_orderItem.oINo
        where mno=#{mno}
        order by mno
    </select>

    <!-- tbl_review 데이터 하나 가져오기(mno 단위) -->
    <select id="getOneByRno" resultType="com.green.team4.vo.sw.ReviewMpVO">
        select tbl_review.rno, tbl_review.pno, tbl_review.mno, tbl_review.oINo, tbl_review.rRating,
               tbl_review.rContent, tbl_review.LIKEHIT, tbl_review.rRegdate, tbl_review.rUpdatedate,
               tbl_orderItem.iName, tbl_orderItem.iOption, tbl_orderItem.iOptionName, tbl_orderItem.iOption2,
               tbl_orderItem.iOptionName2, tbl_orderItem.iColor, tbl_orderItem.iPrice, tbl_orderItem.iDiscount,
               tbl_orderItem.iDisPrice, tbl_orderItem.iCount, tbl_orderItem.iSavePoint, tbl_orderItem.iTotalPrice
        from tbl_review
        left outer join tbl_orderItem on tbl_review.oINo = tbl_orderItem.oINo
        where rno=#{rno}
    </select>

    <!-- tbl_review 데이터 수정 -->
    <update id="update">
        update tbl_review
        set rRating=#{rRating}, rContent=#{rContent}, likeHit=#{likeHit}, rUpdatedate=#{rUpdatedate}
        where rno=#{rno}
    </update>

    <!-- tbl_review 데이터 삭제 -->
    <delete id="delete">
        delete from tbl_review where rno=#{rno}
    </delete>

</mapper>