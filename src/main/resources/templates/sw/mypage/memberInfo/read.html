<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<script src="https://code.jquery.com/jquery-3.6.0.js"></script>
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
    <h2>마이페이지-개인정보조회</h2>

    <!-- MemberInfo -->
    <h3>개인정보</h3>
    <form class="forModify" th:action="@{/sw/mypage/memberInfo/memModify}" th:method="post">
        <ul>
            <li>
                <label th:for="mno">mno(hidden 예정)</label>
                <input type="text" name="mno" th:value="${memberInfo.mno}" readonly>
            </li>
            <li>
                <label th:for="id">아이디</label>
                <input type="text" name="id" th:value="${memberInfo.id}" readonly>
            </li>
            <li>
                <label th:for="password">패스워드</label>
                <input type="password" name="password" th:value="${memberInfo.password}">
            </li>
            <li>
                <label th:for="name">이름</label>
                <input type="text" name="name" th:value="${memberInfo.name}" readonly>
            </li>
            <li>
                <label th:for="nickName">닉네임</label>
                <input type="text" name="nickName" th:value="${memberInfo.nickName}">
            </li>
            <li>
                <label th:for="email">이메일</label>
                <input type="text" name="email" th:value="${memberInfo.email}">
            </li>
            <li>
                <label th:for="phoneNum">전화번호</label>
                <input type="text" name="phoneNum" th:value="${memberInfo.phoneNum}">
            </li>
            <li>
                <label th:for="gender">성별</label>
                <input type="text" name="gender" th:value="${memberInfo.gender}" readonly>
            </li>
            <li>
                <label th:for="SSNum">주민등록번호</label>
                <input type="text" name="SSNum" th:value="${memberInfo.SSNum}" readonly>
            </li>
            <li>
                <label th:for="address">우편번호</label>
                <input type="text" name="postcode" id="postcode" th:value="${memberInfo.postcode}">
            </li>
            <div>
                <button type="button" id="getPostCode">우편번호 찾기</button>
            </div>
            <li>
                <label th:for="address">기본 주소</label>
                <input type="text" name="address" id="address" th:value="${memberInfo.address}">
            </li>
            <li>
                <label th:for="address">세부 주소</label>
                <input type="text" name="detailAddress" id="detailAddress" th:value="${memberInfo.detailAddress}">
            </li>

            <input type="submit" value="개인정보 수정등록">
        </ul>
    </form>
    <hr/>

    <!-- shipmentInfo -->
    <h3>배송지 정보</h3>
    <button th:type="button" th:id="goShipAdd">배송지 신규등록</button>
    <div th:each="shipment : ${shipmentList}">
        <ul>
            <li>
                <a th:href="@{/sw/mypage/memberInfo/shipModify(sno=${shipment.sno})}"
                   th:text="${shipment.postcode}+' '+${shipment.address}+' '+${shipment.detailAddress}">
                </a>
                <form th:action="@{/sw/mypage/memberInfo/shipDelete}" method="post">
                    <input type="hidden" name="mno" th:value="${shipment.mno}">
                    <input type="hidden" name="sno" th:value="${shipment.sno}">
                    <input type="hidden" name="postcode" th:value="${shipment.postcode}">
                    <input type="hidden" name="address" th:value="${shipment.address}">
                    <input type="hidden" name="detailAddress" th:value="${shipment.detailAddress}">
                    <input type="submit" value="삭제">
                </form>
            </li>
        </ul>
    </div>
    <hr/>

    <!-- PaymentInfo -->
    <h3>결제 정보</h3>
    <button th:type="button" th:id="goPayAdd">결제정보 신규등록</button>
    <div th:each="payment : ${paymentList}">
        <ul>
            <li>
                <div th:text="${payment.payName}"></div>
                <a th:href="@{/sw/mypage/memberInfo/payModify(pno=${payment.pno})}"
                   th:text="${payment.payContent}"></a>
                <form th:action="@{/sw/mypage/memberInfo/payDelete}" method="post">
                    <input type="hidden" name="mno" th:value="${payment.mno}">
                    <input type="hidden" name="pno" th:value="${payment.pno}">
                    <input type="hidden" name="payName" th:value="${payment.payName}">
                    <input type="hidden" name="payContent" th:value="${payment.payContent}">
                    <input type="submit" value="삭제">
                </form>
            </li>
        </ul>
    </div>

    <hr/>

    <!-- 회원 탈퇴 -->
    <form th:action="@{/sw/mypage/memberInfo/memDelete}" th:method="get">
        <input type="hidden" name="mno" th:value="${memberInfo.mno}">
        <input type="submit" value="회원탈퇴">
    </form>

    <!-- Mypage 메인으로 돌아가기 버튼 -->
    <button class="button" th:id="goBack">마이페이지 메인으로 돌아가기</button>
</body>

<script src="http://dmaps.daum.net/map_js_init/postcode.v2.js?autoload=false"></script>
<script>
    $(document).ready(function (){

        // 우편번호 검색 버튼 클릭하면
        $("#getPostCode").click(function (){
            daum.postcode.load(function(){
                new daum.Postcode({
                    oncomplete: function(data) {
                        // 우편번호 검색 후 주소 클릭하면 아래 실행
                        $("input[name=postcode]").val(data.zonecode); // 우편번호 태그에 값 업데이트
                        $("input[name=address]").val(data.roadAddress); // 주소 태그에 값 업데이트
                    }
                }).open();
            });
        })

        // Mypage 메인으로 돌아가기 버튼 클릭하면 동작
        $("#goBack").click(function (){
            var mno = $("input[name=mno]").val();
            window.location.href = '/sw/mypage/main?mno='+mno;
        })

        // 배송지 신규 등록 화면 가기 버튼 클릭하면 동작
        $("#goShipAdd").click(function (){
            var mno = $("input[name=mno]").val();
            window.location.href = '/sw/mypage/memberInfo/shipAdd?mno='+mno;
        })

        // 결제정보 신규 등록 화면 가기 버튼 클릭하면 동작
        $("#goPayAdd").click(function (){
            var mno = $("input[name=mno]").val();
            window.location.href = '/sw/mypage/memberInfo/payAdd?mno='+mno;
        })
    })
</script>
</html>