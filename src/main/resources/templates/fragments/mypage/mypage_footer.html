<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<!-- footer fragment -->
<div th:fragment="footerFragment">
    <!-- FOOTER TOP SECTION START -->
    <div class="footer-top-section section pt-100 pb-60">
        <div class="container">
            <div class="row">

                <!-- Footer Widget -->
                <div class="footer-widget col-lg-4 col-md-6 col-12 mb-40">
                    <h5 class="widget-title">ABOUT THE STORE</h5>
                    <p>There are many variations of passages of Lor available, but the majority have suffered alteration in some form, by injected humour, or randomised words which don't look even slightly believable</p>
                </div>

                <!-- Footer Widget -->
                <div class="footer-widget col-lg-3 col-md-6 col-12 mb-40">
                    <h5 class="widget-title">CUSTOMER SERVICE</h5>
                    <ul>
                        <li><a href="#">Contact Us</a></li>
                        <li><a href="#">Returns & Refunds</a></li>
                        <li><a href="#">Terms & Conditions</a></li>
                        <li><a href="#">online store</a></li>
                    </ul>
                </div>

                <!-- Footer Widget -->
                <div class="footer-widget col-lg-2 col-md-6 col-12 mb-40">
                    <h5 class="widget-title">PROFILE</h5>
                    <ul>
                        <li><a href="#">my Account</a></li>
                        <li><a href="#">Checkout</a></li>
                        <li><a href="#">help</a></li>
                        <li><a href="#">support</a></li>
                    </ul>
                </div>

                <!-- Footer Widget -->
                <div class="footer-widget col-lg-3 col-md-6 col-12 mb-40">
                    <h5 class="widget-title">SIGN UP FOR OUR AWESOME NEWS</h5>
                    <div class="footer-social fix">
                        <a href="#"><i class="fa fa-facebook"></i></a>
                        <a href="#"><i class="fa fa-twitter"></i></a>
                        <a href="#"><i class="fa fa-instagram"></i></a>
                        <a href="#"><i class="fa fa-pinterest"></i></a>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!-- FOOTER TOP SECTION END -->

    <!-- FOOTER BOTTOM SECTION START -->
    <div class="footer-bottom-section section">
        <div class="container">
            <div class="row justify-content-between align-items-center">
                <!-- Copyright -->
                <div class="copyright text-left col-md-auto col-12">
                    <p>Powered by <a href="https://hastech.company/">HasTech</a></p>
                </div>
                <!-- Payment Method -->
                <div class="footer-menu text-right col-md-auto col-12">
                    <a href="#">Help & Support</a>
                </div>
            </div>
        </div>
    </div>
    <!-- FOOTER BOTTOM SECTION END -->
    <!-- Modernizr JS -->
    <script src="/js/vendor/modernizr-2.8.3.min.js"></script>
    <!-- jQuery latest version -->
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <!-- Bootstrap js -->
    <script src="/js/bootstrap.bundle.min.js"></script>
    <!-- Plugins js -->
    <script src="/js/plugins.js"></script>
    <!-- Ajax Mail js -->
    <script src="/js/ajax-mail.js"></script>
    <!-- Main js -->
    <script src="/js/main.js"></script>
    <!--카테고리 js (JH추가)-->
    <script src="/js/category.js"></script>

    <!-- 카트 메뉴 데이터 (SW 추가 0605) -->
    <script>
        $(document).ready(function (){
            // 장바구니 총 개수 업데이트용 (회원번호 인식될때만 작동)
            // var mno = $("input[name=mno]").val();
            // if(mno!==undefined){
            //     var data ={mno:mno}
            //     console.log("입력받은 data: ",data)
            //     $.ajax({
            //         url:'/sw/mypage/cart/listCnt',
            //         method:'post',
            //         data:JSON.stringify(data),
            //         contentType:'application/json; charset=utf-8',
            //         dataType:'text',
            //         success:function (cartCnt){
            //             console.log("Ajax통신 성공 후 받은 carCnt: ",cartCnt); // 받아온 데이터
            //             $("#cartCntSpan").text(cartCnt); // 장바구니 상품 개수 업데이트
            //         }
            //     })
            // }
        })

        // 카트 상단 버튼 누르면

            $(".uploadCartResult").empty(); // 데이터 중복 방지

            // id 가져오기
            var id = $("input[name=id]").val();

            // 비회원일때
            if(id === 'anonymousUser'){
                var str2 = "";
                str2 += "<p>"+"로그인 후 이용해주세요:)"+"</p>";
                $(".uploadCartResult").append(str2);
                // return;
            }
            else {
                // 회원일때
                var data ={id:id}

                console.log("입력받은 data: ",data)
                $.ajax({
                    url:'/sw/mypage/cart/listMain',
                    method:'post',
                    data:JSON.stringify(data),
                    contentType:'application/json; charset=utf-8',
                    dataType:'json',
                    success:function (cartList){
                        // 받아온 데이터
                        console.log("Ajax통신 성공 후 받은 cartList: ",cartList);
                        console.log(cartList[0]) // 장바구니 상품 2개 담긴 배열
                        console.log(cartList[1][0].cartCnt) // 장바구니 상품 전체 개수
                        console.log(cartList[1][0].mno) // 접속한 회원 mno

                        var recentCartList = cartList[0];
                        var cartTotalCnt = cartList[1][0].cartCnt;
                        var mnoSec = cartList[1][0].mno;

                        // 장바구니 상품 개수 업데이트
                        $("#cartCntSpan").text(cartTotalCnt);

                        // mno 업데이트
                        $("input[name=mnoSec]").val(mnoSec);

                        // 장바구니 최근 2개 상품 업데이트
                        var cartListDiv = $(".uploadCartResult"); // 태그 추가할 영역
                        var str = "";

                        if(cartList[0][0].status !== '없음'){ // 장바구니 상품이 1개 이상이면
                            $(recentCartList).each(function (){
                                console.log("들어오나")
                                str+="<div class=\"single-cart clearfix\">"
                                str+="<div class=\"cart-image\">";
                                str+="<a href=\'/shop/read?pno="+this.pno+"&mno="+this.mno+"\'>"
                                str+="<img height='70' src=\'/display?fileName="+this.pimage+"\'>"
                                str+="</a>"
                                str+="</div>"
                                str+="<div class=\"cart-info\">";
                                str+="<h5><a>"+this.cname+"</a></h5>";
                                str+="<p style='font-size: small'>"+"["+this.coption+" / "+this.coption2+" / "+this.ccolor+"]"+"</p>";
                                str+="<p>"+this.ccount+"개"+"</p>";
                                str+="</div>"
                                str+="</div>"
                            })
                            cartListDiv.append(str);
                        }
                        else { // 장바구니가 비어있으면
                            console.log("들어오나2")
                            str += "<p>"+"장바구니가 비어있습니다"+"</p>";
                            cartListDiv.append(str);
                        }
                    }
                })
            }


    </script>

    </div>
    <!-- Body main wrapper end -->


</html>
